# DeathDelete ©️2025 KisaragiIchigo

## 📌 概要

DeathDelet は、指定したファイル／フォルダを **自動で削除**するツールです。

* 起動時に **パスワード認証**（3回失敗で強制削除）
* **放置 72 時間**でも強制削除
* 設定ファイルは暗号化して保存（`secret.key` が必要）

> 想定OS: **Windows 10/11**
> 推奨: 初回セットアップとタスク登録は **管理者権限**で

---

## 🧩 構成（役割と保管場所）

| ファイル名               | 役割                         | どこに置かれる？             |
| -------------------- | -------------------------- | -------------------- |
| `setup.exe`          | 初期セットアップ用GUI               | 任意（配布フォルダ）           |
| `encryption_key.exe` | 暗号鍵 `secret.key` を作成       | 任意（配布フォルダ）           |
| `MainApp.exe`        | 認証＆全体制御                    | **あなたが選んだ移動先**       |
| `DeleteApp.exe`      | 実削除の実行                     | **あなたが選んだ移動先**       |
| `secret.key`         | 暗号鍵。`yummy.ini` の暗号化/復号に使用 | **あなたが選んだ移動先**       |
| `delset.exe`         | 削除対象リストの設定用GUI             | 任意（配布フォルダに置く想定）      |
| `yummy.ini`          | 削除リスト（暗号化保存）               | **あなたが選んだ移動先**       |
| `yummy_target.enc`   | 「移動先フォルダ」を暗号化して記録          | **delset.exe と同じ場所** |

---

## 🚀 初回セットアップ（手順と狙い）

### 1) `setup.exe` を起動

* 画面のボタンを **上から順に**押していけばOK。

### 2) ① パスワードを決める

* 2回入力で確認 → 内部で **SHA-256** ハッシュ化 → 環境変数 `PASSWORD_HASH` に登録。
* **目的**: MainApp のログイン判定に使う。ハッシュなので元のパスは保存されません。

### 3) ② 暗号キーを作成（`encryption_key.exe`）

* `secret.key` を作ります。**これがないと `yummy.ini` を読めません。**
* **紛失注意**: 失くすと既存の設定を復号できません（再作成すると**別鍵**になります）。

### 4) ②.5 ファイル移動（重要）

* `MainApp.exe` / `DeleteApp.exe` / `secret.key` を **任意のフォルダ**へ **移動**（コピーではなく移動）。
* 同時に、**`yummy_target.enc` が `delset.exe` と同じフォルダ**に作成されます。
* 中身は「さっき選んだ移動先フォルダ」を暗号化したもの。以降、`delset.exe` はこの情報を復号して、**移動先の `secret.key` と `yummy.ini` を扱います。**

### 5) ③ 削除リストを作る（`delset.exe`）

* ドラッグ＆ドロップで削除対象を登録。
* **「設定終了」** または **「設定を保存」** で、`yummy.ini`（暗号化）が **移動先** に作成/更新されます。
* `DeleteApp.exe` のパスも画面から指定可能（隠し場所に置くのも可）。

### 6) ⑤ バッチを生成→タスク登録

* 移動先フォルダに `このパッチを管理者権限で実行してください.bat` を作成。
* 右クリック→**管理者として実行** で、Windows タスクスケジューラに登録されます：

  * `MainApp_OnLogon_Task`（ログオン時に実行）
  * `MainApp_Recurring_Task`（3日ごとに実行）

---

## 🔄 普段の動作

1. PC起動／ログオン → **MainApp** が立ち上がる
2. パスワード入力

   * 成功: そのまま待機
   * **3回失敗**: 認証成功偽装した後、**DeleteApp** を実行（強制削除）
   * **閉じるボタン（✕）3回**: **DeleteApp** を実行（強制削除）
3. **72時間（3日）放置**: 同じく **DeleteApp** を実行

---

## ⚙️ 設定の変更

* `delset.exe` を起動 → リスト編集 → **「設定終了」** / **「設定を保存」**
* 保存先は **移動先フォルダの `yummy.ini`**（暗号化）。

---

## 📂 ディレクトリ例

```
L:\tools\dist\dist\            ← delset.exe と yummy_target.enc はここ
  ├─ delset.exe
  └─ yummy_target.enc

L:\tools\work\                 ← 移動先（実体）
  ├─ MainApp.exe
  ├─ DeleteApp.exe
  ├─ secret.key
  └─ yummy.ini                 ← delset がここへ保存/更新
```

---

## 🗑 アンインストール

1. タスクスケジューラから以下を削除

   * `MainApp_OnLogon_Task`
   * `MainApp_Recurring_Task`
2. **移動先フォルダ** を削除（`MainApp.exe` / `DeleteApp.exe` / `secret.key` / `yummy.ini`）
3. `delset.exe` と同じ場所の `yummy_target.enc` を削除
4. 必要に応じて環境変数 `PASSWORD_HASH` を削除

---

## ❓ トラブルシューティング

* **MainApp が起動しない／すぐ落ちる**
  → `PASSWORD_HASH` が未設定 or 反映されていない。Step①をやり直してください。

* **delset が保存できない／読めない**
  → `secret.key` が見つからない可能性。移動先にあるか確認してください。
  → `yummy_target.enc` が `delset.exe` と同じフォルダにあるか確認してください。

* **`yummy.ini` が更新されない**
  → delset で「設定終了」や「設定を保存」を押したか確認してください。

* **他PCに持っていくと動かない**
  → `yummy_target.enc` は **DPAPI** 暗号化されているため、別PCでは復号できません。新しいPCで再度 Step②.5 を実行してください。

---
